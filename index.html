<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>HeroPay — Top Up Cepat & Aman</title>
    <link rel="icon" href="image/favicon.ico" type="image/x-icon" />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap");
    </style>
    <style>
      * {
        font-family: "Nunito", sans-serif;
      }
      /* ===========================
   DARK MODE REFINEMENT
   =========================== */
      body.dark {
        background: #0d0d0d;
        color: #e5e5e5;
      }

      /* Navbar, header, footer */
      body.dark .nav,
      body.dark header,
      body.dark footer {
        background: #161616 !important;
        color: #f2f2f2;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      }

      /* Search bar dan input */
      body.dark input,
      body.dark .search {
        background: #1f1f1f;
        border: 1px solid #333;
        color: #e5e5e5;
      }
      body.dark input::placeholder {
        color: #888;
      }
      body.dark .hero h1 {
        color: rgb(51, 51, 51);
      }

      body.dark button,
      body.dark .btn,
      body.dark .active {
        background: #bf092f; 
        color: #fff;
        border: none;
      }
      body.dark button:hover,
      body.dark .btn:hover {
        background: #a10828;
      }

      body.dark .game-card {
        background: #151515;
        border: 1px solid #222;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.5);
      }

      body.dark .game-thumb {
        filter: brightness(0.55);
        border-radius: 10px;
      }

      body.dark .panel,
      body.dark .pkg,
      body.dark .total-box {
        background: #121212;
        border: 1px solid #222;
        color: #eee;
      }

      /* Teks kecil & label */
      body.dark .small,
      body.dark .label,
      body.dark p {
        color: #aaa;
      }

      
      body.dark .pkg:hover,
      body.dark .game-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.6);
        transition: 0.25s ease;
      }

    
      body.dark .mode-toggle {
        color: #ffcd4a;
      }
      body.dark .logo {
        background-image: url("./image/logo.png");
      }

      /* ----------------------------
            Variables & Base
            ---------------------------- */
      :root {
        --primary: #bf092f;
        --dark: #222222;
        --muted: #6b7280;
        --card: #ffffff;
        --glass: rgba(255, 255, 255, 0.06);
        --radius: 8px;
        --max-w: 1100px;
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        font-family: Inter, "Segoe UI", Roboto, system-ui, -apple-system,
          "Helvetica Neue", Arial;
        margin: 0;
        background: linear-gradient(180deg, #fafafa 0%, #f3f3f3 60%);
        color: var(--dark);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      a {
        color: inherit;
        text-decoration: none;
      }

      /* ----------------------------
            Container
            ---------------------------- */
      .container {
        max-width: var(--max-w);
        margin: 18px auto;
        padding: 12px;
      }

      /* ----------------------------
            NAVBAR
            ---------------------------- */
      .nav {
        display: flex;
        align-items: center;
        gap: 12px;
        justify-content: space-between;
        background: linear-gradient(90deg, #fff, #fff);
        padding: 10px 14px;
        border-radius: 10px;
        box-shadow: 0 6px 18px rgba(16, 24, 40, 0.06);
        position: sticky;
        top: 12px;
        z-index: 30;
      }
      .brand {
        display: flex;
        gap: 12px;
        align-items: center;
      }
      .logo {
        width: 44px;
        height: 44px;
        border-radius: 6px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 800;
        color: #000000; /* hitam di mode terang */
        background: url("./image/logo-hitam.png") center/cover no-repeat;
      }
      .brand-name {
        font-weight: 700;
        font-size: 16px;
      }
      .nav-right {
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .search {
        display: flex;
        align-items: center;
        gap: 8px;
        background: #f3f4f6;
        border-radius: 8px;
        padding: 8px 10px;
        min-width: 220px;
        box-shadow: inset 0 1px 0 rgba(0, 0, 0, 0.02);
      }
      .search input {
        border: 0;
        background: transparent;
        outline: none;
        font-size: 14px;
        color: var(--dark);
        width: 160px;
      }
      .nav-action-btn {
        background: transparent;
        border: 1px solid rgba(34, 34, 34, 0.06);
        padding: 8px 12px;
        border-radius: 8px;
        cursor: pointer;
      }
      .primary-btn {
        background: var(--primary);
        color: #fff;
        border: 0;
        padding: 9px 14px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 700;
      }

      /* ----------------------------
            HERO
            ---------------------------- */
      .hero {
        margin-top: 18px;
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        background: linear-gradient(180deg, #fff, #fff);
        padding: 18px;
        border-radius: 10px;
        box-shadow: 0 6px 18px rgba(16, 24, 40, 0.04);
      }
      .hero-left {
        max-width: 700px;
      }
      .hero h1 {
        font-size: 20px;
        margin: 0 0 6px;
      }
      .hero p {
        margin: 0;
        color: var(--muted);
      }
      .hero-cta {
        display: flex;
        gap: 10px;
        align-items: center;
      }

      /* ----------------------------
            GAMES SECTION
            ---------------------------- */
      .games {
        margin-top: 18px;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 14px;
      }
      .game-card {
        background: var(--card);
        border-radius: 10px;
        border: 1px solid rgba(34, 34, 34, 0.04);
        padding: 12px;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        height: 100%;
        transition: transform 0.16s, box-shadow 0.16s;
      }
      .game-card:hover {
        transform: translateY(-6px);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
      }
      .game-thumb {
        height: 150px;
        border-radius: 8px;
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover; /* biar pas isi kotak, gak numpuk */
        display: block;
        margin: 0 auto;
        width: 100%;
      }

      /* Thumbnail berbeda tiap game */
      .game-thumb.ml {
        background-image: url("./image/ml.jpg");
        /* pastikan gambar mengisi area dan dipotong dari bagian atas */
        background-position: top center;
        background-size: cover;
        background-repeat: no-repeat;
      }

      .game-thumb.rb {
        background-image: url("./image/rb.jpg");
      }

      .game-thumb.mc {
        background-image: url("./image/mn.png");
        /* pastikan gambar mengisi area dan dipotong dari bagian atas */
        background-position: top center;
        background-size: cover;
        background-repeat: no-repeat;
      }

      .game-title {
        margin-top: 12px;
        font-weight: 700;
        font-size: 15px;
      }
      .game-sub {
        color: var(--muted);
        font-size: 13px;
        margin-top: 6px;
      }

      /* ----------------------------
            LAYOUT: MAIN PANEL (left) + SIDEBAR (right)
            ---------------------------- */
      .layout {
        display: grid;
        grid-template-columns: 1fr 340px;
        gap: 16px;
        margin-top: 18px;
      }
      @media (max-width: 960px) {
        .layout {
          grid-template-columns: 1fr;
        }
      }
      .panel {
        background: var(--card);
        padding: 14px;
        border-radius: 10px;
        border: 1px solid rgba(34, 34, 34, 0.04);
      }
      .panel h3 {
        margin: 0 0 12px;
        font-size: 16px;
      }

      /* ----------------------------
            PRODUCT LIST (like Itemku)
            ---------------------------- */
      .tabs {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin-bottom: 12px;
      }
      .tab-btn {
        padding: 8px 12px;
        border-radius: 999px;
        border: 1px solid rgba(34, 34, 34, 0.06);
        background: #fafafa;
        color: var(--dark);
        cursor: pointer;
        font-weight: 600;
        font-size: 13px;
      }
      .tab-btn.active {
        background: linear-gradient(90deg, var(--primary), #a10b36);
        color: white;
        border-color: transparent;
        box-shadow: 0 6px 18px rgba(191, 9, 47, 0.12);
      }

      .search-nominal {
        display: flex;
        gap: 8px;
        align-items: center;
        margin-top: 8px;
      }
      .search-nominal input {
        flex: 1;
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #e6e6e6;
      }
      .filters {
        display: flex;
        gap: 8px;
        margin-top: 10px;
        flex-wrap: wrap;
      }

      .cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 10px;
        margin-top: 12px;
      }
      .pkg {
        background: #fff;
        border-radius: 8px;
        border: 1px solid #e8e8e8;
        padding: 12px;
        cursor: pointer;
        transition: transform 0.12s, box-shadow 0.12s;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .pkg:hover {
        transform: translateY(-4px);
        box-shadow: 0 10px 24px rgba(34, 34, 34, 0.06);
      }
      .pkg .label {
        font-weight: 700;
      }
      .pkg .price {
        color: var(--primary);
        font-weight: 800;
      }
      .pkg.selected {
        outline: 3px solid rgba(191, 9, 47, 0.12);
        box-shadow: 0 14px 30px rgba(191, 9, 47, 0.06);
        transform: none;
      }

      /* ----------------------------
            FORM / SIDEBAR PAYMENT
            ---------------------------- */
      .sidebar {
        position: sticky;
        top: 86px;
      }
      .form-row {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-bottom: 10px;
      }
      label {
        font-size: 13px;
        color: var(--muted);
      }
      input[type="text"],
      input[type="number"] {
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #e6e6e6;
      }
      .input-error {
        color: #dc2626; /* red */
        font-size: 13px;
        min-height: 18px;
        margin-top: 4px;
      }
      .total-box {
        background: #fff;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #e8e8e8;
        margin-top: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .buy-btn {
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        border: 0;
        background: linear-gradient(90deg, var(--primary), #a10b36);
        color: #fff;
        font-weight: 800;
        margin-top: 12px;
        cursor: pointer;
      }
      .buy-disabled {
        background: #d1d5db;
        color: #6b7280;
        cursor: not-allowed;
      }

      /* small text & footer */
      .small {
        font-size: 13px;
        color: var(--muted);
      }
      footer {
        margin-top: 24px;
        text-align: center;
        padding: 18px 6px;
        color: var(--muted);
      }

      /* ----------------------------
            MOBILE ADJUSTMENTS & ANIMATIONS
            ---------------------------- */
      @media (max-width: 640px) {
        .nav {
          padding: 10px;
        }
        .search {
          min-width: 120px;
        }
        .hero h1 {
          font-size: 18px;
        }
        .layout {
          grid-template-columns: 1fr;
        }
        .sidebar {
          position: static;
        }
        /* Tampilkan nama brand pada layar kecil (mobile) */
        .brand-name {
          display: block;
          font-size: 14px;
          line-height: 1;
          font-weight: 700;
        }
        /* Sedikit kecilkan logo agar muat bersama teks di navbar pada layar sempit */
        .logo {
          width: 36px;
          height: 36px;
        }
        /* Sembunyikan teks penjelas agar ruang lebih lega di mobile */
        .brand .small {
          display: none;
        }
        .nav-action-btn{
          font-size:12px;
        }
        .hero-left p{
          font-size:12px;
        }
        .primary-btn{
          padding:5px 8px;
          font-size:10px;
        }
        
      }

      /* subtle entrance */
      .fade-in {
        opacity: 0;
        transform: translateY(8px);
        animation: enter 0.45s forwards;
      }
      @keyframes enter {
        to {
          opacity: 1;
          transform: none;
        }
      }

      /* ----------------------------
            POPUP MODAL
            ---------------------------- */
      #popupModal {
        display: none;
        position: fixed;
        z-index: 9999;
        left: 0;
        top: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.55);
        justify-content: center;
        align-items: center;
      }

      #popupModal .modal-content {
        position: relative;
        background: #fff;
        border-radius: 12px;
        max-width: 95vw;
        max-height: 90vh;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
        overflow: hidden;
      }

      #closePopup {
        position: absolute;
        top: 8px;
        right: 8px;
        background: rgba(0, 0, 0, 0.5);
        color: #fff;
        border: none;
        border-radius: 50%;
        width: 32px;
        height: 32px;
        font-size: 20px;
        cursor: pointer;
        z-index: 2;
      }

      #popupModal img {
        display: block;
        max-width: 100vw;
        max-height: 80vh;
        width: auto;
        height: auto;
      }

      /* SLIDESHOW / PROMO BANNER */
      .slideshow {
        margin-top: 12px;
        display: block;
        max-width: var(--max-w);
        margin-left: auto;
        margin-right: auto;
      }
      .slideshow-container {
        position: relative;
        overflow: hidden;
        border-radius: 10px;
        background: #000;
        transition: height 0.28s ease; /* animasi saat tinggi berubah */
        touch-action: pan-y; /* biarkan scroll vertikal, kita tangani swipe horizontal */
        user-select: none;
        -webkit-user-select: none;
      }
      /* slides positioned absolutely and crossfaded via opacity */
      .slide {
        position: absolute;
        inset: 0;
        width: 100%;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.6s ease;
        z-index: 1;
        display: block;
      }
      .slide.active {
        opacity: 1;
        pointer-events: auto;
        z-index: 2;
      }
      .slide img {
        width: 100%;
        height: auto;
        object-fit: cover;
        display: block;
        /* position: absolute; height: 100%; width: 100%; inset: 0px; color: transparent; */
      }
      .prev, .next {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(0,0,0,0.45);
        color: #fff;
        border: none;
        width: 38px;
        height: 38px;
        border-radius: 999px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 18px;
        transition: background 0.18s, transform 0.08s;
        z-index: 20; /* selalu di atas slide sehingga tidak tertutupi */
      }
      .prev { left: 12px; }
      .next { right: 12px; }
      .prev:hover, .next:hover,
      .prev:active, .next:active {
        background: var(--primary);
        color: #fff;
        transform: translateY(-50%) scale(0.98);
      }
      .dots {
        display: flex;
        gap: 8px;
        justify-content: center;
        margin-top: 8px;
        z-index: 20; /* agar tetap bisa diklik di atas slide */
        position: relative;
      }
      .dots button {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        border: none;
        background: rgba(0,0,0,0.18);
        cursor: pointer;
        padding: 0;
      }
      .dots button.active {
        background: var(--primary);
        box-shadow: 0 4px 10px rgba(191,9,47,0.16);
      }
 
       /* Make some other interactive buttons match the red on hover/active */
       .nav-action-btn:hover, .nav-action-btn:active,
       .tab-btn:hover, .tab-btn:active {
         background: var(--primary);
         color: #fff;
         border-color: transparent;
       }
    </style>
  </head>
  <body>
    <!-- POPUP MODAL -->
    <div id="popupModal" style="display:none; position:fixed; z-index:9999; left:0; top:0; width:100vw; height:100vh; background:rgba(0,0,0,0.55); justify-content:center; align-items:center;">
      <div style="position:relative; background:#fff; border-radius:12px; max-width:95vw; max-height:90vh; box-shadow:0 8px 32px rgba(0,0,0,0.25); overflow:hidden;">
        <button id="closePopup" aria-label="Tutup" style="position:absolute; top:8px; right:8px; background:rgba(0,0,0,0.5); color:#fff; border:none; border-radius:50%; width:32px; height:32px; font-size:20px; cursor:pointer; z-index:2;">&times;</button>
        <img src="image/Welcome-Claude.png" alt="Promo" style="display:block; max-width:100vw; max-height:80vh; width:auto; height:auto;">
      </div>
    </div>

    <div class="container">
      <!-- NAVBAR -->
      <header
        class="nav fade-in"
        role="navigation"
        aria-label="Main navigation"
      >
        <div class="brand">
          <div class="logo"></div>
          <div>
            <div class="brand-name">
              Hero<span style="color: orange;">Pay</span>
            </div>
            <div class="small">Top Up Aman & Enjoy</div>
          </div>
        </div>

        <div style="display: flex; gap: 12px; align-items: center">
          <button class="nav-action-btn" id="darkToggle" onclick="toggleDark()">
            🌙
          </button>
          <button class="primary-btn" onclick="openLogin()">Masuk</button>
        </div>
      </header>

      <!-- SLIDESHOW: di bawah navbar dan di atas hero -->
      <div class="slideshow fade-in" id="promoSlideshow" aria-label="Slideshow promosi">
        <div class="slideshow-container" id="slidesContainer">
          <div class="slide"><img src="./image/aspirant-iklan.jpg" alt="Iklan 1"></div>
          <div class="slide"><img src="./image/Welcome-Claude.png" alt="Welcome Poster"></div>
          <div class="slide"><img src="./image/ml.jpg" alt="Mobile Legends"></div>
          <div class="slide"><img src="./image/mn.png" alt="MN"></div>
          <div class="slide"><img src="./image/xavier.jpg" alt="Iklan 2"></div>

          <button class="prev" id="slidePrev" aria-label="Sebelumnya">&lt;</button>
          <button class="next" id="slideNext" aria-label="Selanjutnya">&gt;</button>
        </div>
        <div class="dots" id="slideDots" aria-hidden="false"></div>
      </div>

      <!-- HERO -->
      <section class="hero fade-in">
        <div class="hero-left">
          <h1>Top up cepat untuk Mobile Legends & Free Fire</h1>
          <p>
            Proses instan, harga kompetitif, dan dukungan order via WhatsApp.
          </p>
        </div>
        <div class="hero-cta">
          <button class="nav-action-btn" onclick="scrollToGames()">
            Mulai Top Up
          </button>
        </div>
      </section>

      <!-- GAMES -->
      <section class="games fade-in" id="games">
        <div class="game-card" onclick="selectGame('Mobile Legends')">
          <div class="game-thumb ml"></div>
          <div class="game-title">Mobile Legends</div>
          <div class="game-sub">Diamond resmi & paket event</div>
        </div>

        <div class="game-card" onclick="selectGame('Free Fire')">
          <div class="game-thumb mc"></div>
          <div class="game-title">Free Fire</div>
          <div class="game-sub">Diamond resmi & paket event</div>
        </div>
      </section>

      <!-- LAYOUT: MAIN + SIDEBAR -->
      <div class="layout fade-in" style="align-items: start">
        <!-- MAIN PANEL: produk & paket -->
        <main class="panel" id="mainPanel">
          <h3 id="panelTitle">Pilih Game</h3>

          <!-- Tabs & filters -->
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              gap: 12px;
              flex-wrap: wrap;
            "
          >
            <div class="tabs" id="productTabs">
              <button class="tab-btn active" data-type="diamond">
                Diamond
              </button>
            </div>
          </div>

          <div class="filters small" id="quickFilters" style="margin-top: 10px">
            <!-- Removed quick filter buttons -->
          </div>

          <!-- Produk grid -->
          <div class="cards-grid" id="packagesGrid" style="margin-top: 14px">
            <!-- Paket akan di-generate lewat JS -->
          </div>
        </main>

        <!-- SIDEBAR: form & pembayaran -->
        <aside class="panel sidebar" id="sidebar">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
            "
          >
            <div>
              <div class="small">Game</div>
              <div id="selGame" style="font-weight: 800">
                Belum ada yang dipilih
              </div>
            </div>
          </div>

          <div style="margin-top: 12px">
            <div class="form-row">
              <label for="userId">User ID</label>
              <input id="userId" type="text" placeholder="Contoh: 12345678" />
              <div id="userIdError" class="input-error" aria-live="polite"></div>
            </div>
            <div class="form-row">
              <label for="zoneId">Zone ID</label>
              <input id="zoneId" type="text" placeholder="Contoh: 2020" />
              <div id="zoneIdError" class="input-error" aria-live="polite"></div>
            </div>

            <div class="form-row small">
              <label>Paket terpilih</label>
              <div id="chosenPkg">Belum ada paket</div>
            </div>

            <div class="total-box">
              <div class="small">Total</div>
              <div
                id="totalPrice"
                style="font-weight: 800; color: var(--primary)"
              >
                Rp0
              </div>
            </div>

            <button id="buyBtn" class="buy-btn buy-disabled" onclick="buyNow()">
              Beli Sekarang
            </button>
            <div class="small" style="margin-top: 8px; font-weight: bold; color: var(--primary);">
              *Pembayaran Hanya Melalui QRIS
            </div>
            <div class="small" style="margin-top: 8px">
              Pesanan akan diarahkan ke WhatsApp. Pastikan ID dan paket benar.
              <br>
              Masukan id / username terlebih dahulu baru masukan nominal pembelian. 
            </div>
          </div>
        </aside>
      </div>

      <footer>
        <div class="small">
          © 2025 HeroPay • Syarat & Ketentuan • Kebijakan Privasi
        </div>
      </footer>
    </div>

    <script>
       /* ----------------------------
         Data paket per game (contoh mirip screenshot)
         ---------------------------- */
       const nomorWA = "6287874511180"; // nomor 
       const data = {
         "Mobile Legends": [
          { id: "ml-wdp", label: "Weekly Diamond Pass", price: 33000, stock: 999 },
           { id: "ml-3", label: "3 Diamonds", price: 1600, stock: 999 },
           { id: "ml-5", label: "5 Diamonds", price: 1800, stock: 999 },
           { id: "ml-12", label: "12 Diamonds", price: 4000, stock: 999 },
           { id: "ml-19", label: "19 Diamonds", price: 6100, stock: 999 },
           { id: "ml-28", label: "28 Diamonds", price: 9000, stock: 999 },
           { id: "ml-44", label: "44 Diamonds", price: 13000, stock: 999 },
           { id: "ml-59", label: "59 Diamonds", price: 17300, stock: 999 },
           { id: "ml-85", label: "85 Diamonds", price: 26000, stock: 20 },
           { id: "ml-170", label: "170 Diamonds", price: 50500, stock: 10 },
           { id: "ml-240", label: "240 Diamonds", price: 74000, stock: 10 },
           { id: "ml-296", label: "296 Diamonds", price: 90000, stock: 10 },
           { id: "ml-408", label: "408 Diamonds", price: 125000, stock: 10 },
           { id: "ml-568", label: "568 Diamonds", price: 170000, stock: 10 },
           { id: "ml-875", label: "875 Diamonds", price: 250000, stock: 10 },
           { id: "ml-2010", label: "2010 Diamonds", price: 535000, stock: 10 },
           { id: "ml-4830", label: "4830 Diamonds", price: 1270000, stock: 10 },            
         ],
         "Free Fire": [
           { id: "ff-5", label: "5 Diamonds", price: 1500, stock: 100 },
           { id: "ff-12", label: "12 Diamonds", price: 2500, stock: 100 },
           { id: "ff-50", label: "50 Diamonds", price: 9000, stock: 100 },
           { id: "ff-70", label: "70 Diamonds", price: 11500, stock: 50 },
           { id: "ff-140", label: "140 Diamonds", price: 22000, stock: 50 },
           { id: "ff-355", label: "355 Diamonds", price: 52000, stock: 20 },
           { id: "ff-720", label: "720 Diamonds", price: 105000, stock: 20 },
           { id: "ff-1450", label: "1450 Diamonds", price: 205000, stock: 20 },
         ],
       };

       /* ----------------------------
         State
         ---------------------------- */
       let selectedGame = null;
       let selectedPkg = null;

       /* ----------------------------
         Helpers
         ---------------------------- */
       function formatRupiah(n) {
         if (!n) return "Rp0";
         return "Rp" + n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
       }

       /* ----------------------------
         Render paket ke grid
         ---------------------------- */
       const packagesGrid = document.getElementById("packagesGrid");
       const panelTitle = document.getElementById("panelTitle");

       function renderPackages(game, filter = null) {
         packagesGrid.innerHTML = "";
         if (!game) {
           panelTitle.textContent = "Pilih Game";
           return;
         }
         panelTitle.textContent = `Produk — ${game}`;
         const list = data[game] || [];
         
         // Exclude "Weekly Diamond Pass" from the default "Diamond" tab
         const filteredList = filter
           ? list.filter(filter)
           : list.filter((p) => p.id !== "ml-wdp");

         filteredList.forEach((p) => {
           const el = document.createElement("div");
           el.className = "pkg";
           el.dataset.pkgId = p.id;
           el.dataset.pkgPrice = p.price;
           el.dataset.pkgLabel = p.label;

            // Add specific thumbnail for each game and specific package ids
            let thumbnail = "";
            if (game === "Mobile Legends") {
              if (p.id === "ml-wdp") {
                thumbnail = `<img src="./image/wdp.png" alt="Weekly Diamond Pass" style="width: 24px; height: 24px; margin-right: 8px;">`;
              } else if (["ml-28","ml-44","ml-59"].includes(p.id)) {
                // group 2 -> ml-diamond-2.png
                thumbnail = `<img src="./image/ml-diamond-2.png" alt="Diamond" style="width: 24px; height: 24px; margin-right: 8px;">`;
              } else if (["ml-85","ml-170","ml-240"].includes(p.id)) {
                // group 3 -> ml-diamond-3.png
                thumbnail = `<img src="./image/ml-diamond-3.png" alt="Diamond" style="width: 24px; height: 24px; margin-right: 8px;">`;
              } else if (["ml-875","ml-2010","ml-4830"].includes(p.id)) {
                // new group -> ml-diamond-5.png (requested)
                thumbnail = `<img src="./image/ml-diamond-5.png" alt="Diamond Premium" style="width: 24px; height: 24px; margin-right: 8px;">`;
              } else if (["ml-296","ml-408","ml-568"].includes(p.id)) {
                // group 4 -> ml-diamond-4.png
                thumbnail = `<img src="./image/ml-diamond-4.png" alt="Diamond" style="width: 24px; height: 24px; margin-right: 8px;">`;
              } else {
                thumbnail = `<img src="./image/ml-diamond.png" alt="Diamond" style="width: 24px; height: 24px; margin-right: 8px;">`;
              }
            } else if (game === "Free Fire") {
              // Use Free Fire specific diamond image
              thumbnail = `<img src="./image/Freefire_diamonds.png" alt="Diamond Free Fire" style="width: 24px; height: 24px; margin-right: 8px;">`;
            }

           el.innerHTML = `
             <div style="display: flex; align-items: center;">
               ${thumbnail}
               <div class="label">${p.label}</div>
             </div>
             <div class="price">${formatRupiah(p.price)}</div>
           `;
           el.onclick = () => choosePackage(el, p);
           packagesGrid.appendChild(el);
         });
       }

       function renderTabs(game) {
         const productTabs = document.getElementById("productTabs");
         productTabs.innerHTML = "";

         // Diamond tab
         const diamondTab = document.createElement("button");
         diamondTab.className = "tab-btn active";
         diamondTab.textContent = "Diamond";
         diamondTab.onclick = () => {
           document.querySelectorAll(".tab-btn").forEach((btn) => btn.classList.remove("active"));
           diamondTab.classList.add("active");
           renderPackages(game);
         };
         productTabs.appendChild(diamondTab);

         // Weekly Diamond Pass tab (only for Mobile Legends)
         if (game === "Mobile Legends") {
           const wdpTab = document.createElement("button");
           wdpTab.className = "tab-btn";
           wdpTab.textContent = "Weekly Diamond Pass";
           wdpTab.onclick = () => {
             document.querySelectorAll(".tab-btn").forEach((btn) => btn.classList.remove("active"));
             wdpTab.classList.add("active");
             renderPackages(game, (p) => p.id === "ml-wdp");
           };
           productTabs.appendChild(wdpTab);
         }
       }

       function selectGame(game) {
         selectedGame = game;
         document.getElementById("selGame").textContent = game;
         renderTabs(game); // Render tabs dynamically
         renderPackages(game); // Show all packages by default
         document.getElementById("mainPanel").scrollIntoView({ behavior: "smooth", block: "start" });
         selectedPkg = null;
        // Toggle Zone ID visibility for games that don't need it (e.g. Free Fire)
        toggleZoneField();
        updateSidebar();
       }

       /* ----------------------------
         Choose package
         ---------------------------- */
       function choosePackage(el, p) {
         // unselect others
         document
           .querySelectorAll(".pkg")
           .forEach((x) => x.classList.remove("selected"));
         el.classList.add("selected");
         selectedPkg = p;
         document.getElementById("chosenPkg").textContent = `${
           p.label
         } — ${formatRupiah(p.price)}`;
         document.getElementById("totalPrice").textContent = formatRupiah(
           p.price
         );
         updateSidebar();

         // Tambahkan scroll ke kolom ID/pembayaran jika di mobile
         if (window.innerWidth <= 640) {
           // Scroll ke sidebar (form pembayaran)
           document.getElementById("sidebar").scrollIntoView({ behavior: "smooth", block: "start" });
           // Fokus ke input User ID
           setTimeout(() => {
             document.getElementById("userId")?.focus();
           }, 400);
         }
       }

       /* ----------------------------
         Update sidebar state (enable button)
         ---------------------------- */
       function updateSidebar() {
         const buyBtn = document.getElementById("buyBtn");
         const uid = document.getElementById("userId").value.trim();
         const zid = (document.getElementById("zoneId")?.value || "").trim();

         // Button visually indicates disabled state, but remains clickable so
         // the buyNow() handler can show inline errors when fields are missing.
         const enabled = !!(selectedGame && selectedPkg && uid && zid);

         if (enabled) {
           buyBtn.classList.remove("buy-disabled");
           buyBtn.setAttribute("aria-disabled", "false");
         } else {
           buyBtn.classList.add("buy-disabled");
           buyBtn.setAttribute("aria-disabled", "true");
         }
       }

      /* ---------------------------- buy -> WA ---------------------------- */
     

       /* ----------------------------
         quick helpers
         ---------------------------- */
       function scrollToGames() {
         document.getElementById("games").scrollIntoView({ behavior: "smooth" });
       }
       function scrollToSection() {
         window.scrollTo({ top: 0, behavior: "smooth" });
       }
       function openLogin() {
         window.location.href = "login.html";
       }
       function clearFilter() {
         document.getElementById("nominalFilter").value = "";
         renderPackages(selectedGame);
       }

       function applyQuick(k) {
         // simple demo: sort / filter
         if (!selectedGame) {
           alert("Pilih game dulu untuk filter.");
           return;
         }
         const list = data[selectedGame].slice();
         if (k === "cheap") {
           list.sort((a, b) => a.price - b.price);
         } else if (k === "popular") {
           list.sort((a, b) => b.stock - a.stock);
         } else if (k === "instant") {
           /* keep order or implement priority */
         }
         packagesGrid.innerHTML = "";
         list.forEach((p) => {
           const el = document.createElement("div");
           el.className = "pkg";
           el.dataset.pkgId = p.id;
           el.dataset.pkgPrice = p.price;
           el.dataset.pkgLabel = p.label;

            // reuse same thumbnail rules as renderPackages
            let thumbnail = "";
            if (selectedGame === "Mobile Legends") {
              if (p.id === "ml-wdp") {
                thumbnail = `<img src="./image/wdp.png" alt="Weekly Diamond Pass" style="width: 24px; height: 24px; margin-right: 8px;">`;
              } else if (["ml-28","ml-44","ml-59"].includes(p.id)) {
                thumbnail = `<img src="./image/ml-diamond-2.png" alt="Diamond" style="width: 24px; height: 24px; margin-right: 8px;">`;
              } else if (["ml-85","ml-170","ml-240"].includes(p.id)) {
                thumbnail = `<img src="./image/ml-diamond-3.png" alt="Diamond" style="width: 24px; height: 24px; margin-right: 8px;">`;
              } else if (["ml-875","ml-2010","ml-4830"].includes(p.id)) {
                // new group -> ml-diamond-5.png (requested)
                thumbnail = `<img src="./image/ml-diamond-5.png" alt="Diamond Premium" style="width: 24px; height: 24px; margin-right: 8px;">`;
              } else if (["ml-296","ml-408","ml-568"].includes(p.id)) {
                thumbnail = `<img src="./image/ml-diamond-4.png" alt="Diamond" style="width: 24px; height: 24px; margin-right: 8px;">`;
              } else {
                thumbnail = `<img src="./image/ml-diamond.png" alt="Diamond" style="width: 24px; height: 24px; margin-right: 8px;">`;
              }
            } else if (selectedGame === "Free Fire") {
              thumbnail = `<img src="./image/Freefire_diamonds.png" alt="Diamond Free Fire" style="width: 24px; height: 24px; margin-right: 8px;">`;
            }

            el.innerHTML = `<div style="display:flex; align-items:center;">
                      ${thumbnail}
                      <div class="label">${p.label}</div>
                    </div>
                    <div class="price">${formatRupiah(p.price)}</div>
                    <div class="small">Stok: ${p.stock}</div>`;
            el.onclick = () => choosePackage(el, p);
            packagesGrid.appendChild(el);
         });
       }

  /* initial render - nothing selected */
  renderPackages(null);

      // Listen to input changes to update button state and clear inline errors
      const uidInput = document.getElementById('userId');
      const zidInput = document.getElementById('zoneId');
      function clearFieldError(fieldId) {
        const el = document.getElementById(fieldId + 'Error');
        if (el) el.textContent = '';
      }
      if (uidInput) {
        uidInput.addEventListener('input', () => {
          clearFieldError('userId');
          updateSidebar();
        });
      }
      if (zidInput) {
        zidInput.addEventListener('input', () => {
          clearFieldError('zoneId');
          updateSidebar();
        });
      }

      // Toggle Zone ID visibility depending on selected game
      function toggleZoneField() {
        const zidEl = document.getElementById('zoneId');
        if (!zidEl) return;
        // try to find the row wrapper (has class form-row)
        const row = zidEl.closest ? zidEl.closest('.form-row') : zidEl.parentElement;
        if (!row) return;
        if (selectedGame === 'Free Fire') {
          // hide field and clear any errors/values
          row.style.display = 'none';
          zidEl.value = '';
          const err = document.getElementById('zoneIdError'); if (err) err.textContent = '';
        } else {
          row.style.display = '';
        }
      }

      // Update sidebar state (enable button)
      function updateSidebar() {
        const buyBtn = document.getElementById("buyBtn");
        const uid = document.getElementById("userId").value.trim();
        const zid = (document.getElementById("zoneId")?.value || "").trim();

        // For Free Fire we do not require Zone ID
        const needZone = selectedGame !== 'Free Fire';

        // Button visually indicates disabled state, but remains clickable so
        // the buyNow() handler can show inline errors when fields are missing.
        const enabled = !!(selectedGame && selectedPkg && uid && (needZone ? zid : true));

        if (enabled) {
          buyBtn.classList.remove("buy-disabled");
          buyBtn.setAttribute("aria-disabled", "false");
        } else {
          buyBtn.classList.add("buy-disabled");
          buyBtn.setAttribute("aria-disabled", "true");
        }
      }

      // Ensure state is correct on initial load
      toggleZoneField();
      updateSidebar();

       /* small accessibility: press Enter on search to focus panel */
       document
         .getElementById("globalSearch")
         .addEventListener("keydown", (e) => {
           if (e.key === "Enter") {
             e.preventDefault();
           }
         });
       /* ---------- DARK MODE TOGGLE ---------- */
       function toggleDark() {
         const body = document.body;
         const btn = document.getElementById("darkToggle");
         body.classList.toggle("dark");
         btn.textContent = body.classList.contains("dark")
           ? "☀️ "
           : "🌙 ";
         localStorage.setItem(
           "darkmode",
           body.classList.contains("dark") ? "true" : "false"
         );
       }
       (function () {
         if (localStorage.getItem("darkmode") === "true") {
           document.body.classList.add("dark");
           document.getElementById("darkToggle").textContent = "☀️ ";
         }
       })();
    </script>
   <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
async function buyNow() {
  const uid = document.getElementById('userId').value.trim();
  const zid = document.getElementById('zoneId')?.value.trim() || "";
  // clear previous inline errors
  document.getElementById('userIdError').textContent = '';
  document.getElementById('zoneIdError').textContent = '';

  if (!selectedGame) {
    Swal.fire('Oops!', 'Silakan pilih game terlebih dahulu.', 'warning');
    return;
  }

  // If package (katalog) not chosen -> show popup informing user
  if (!selectedPkg) {
    Swal.fire({
      icon: 'warning',
      title: 'Pilih katalog pesanan',
      text: 'Silakan pilih katalog/paket yang ingin dipesan sebelum melanjutkan.'
    });
    return;
  }

  // If User ID missing -> show inline error below the field
  if (!uid) {
    document.getElementById('userIdError').textContent = 'harap diisi';
    document.getElementById('userId').focus();
    return;
  }

  // If Zone ID missing -> show inline error below the field
  // If Zone ID missing (for games that require it) -> show inline error
  if (selectedGame !== 'Free Fire' && !zid) {
    document.getElementById('zoneIdError').textContent = 'harap diisi';
    document.getElementById('zoneId').focus();
    return;
  }

  // ===== NEW: tampilkan instruksi popup sebelum menuju WhatsApp =====
  const info = await Swal.fire({
    icon: 'info',
    title: 'Langkah Konfirmasi',
    text: 'Silahkan ketik pesan bertuliskan "HeroPay" pada chat Whatsapp untuk mengkonfirmasi dengan Admin, dan anda bisa memesan kembali supaya muncul teks otomatisnya ☺🙏',
    showCancelButton: true,
    confirmButtonText: 'Lanjut ke WhatsApp',
    cancelButtonText: 'Batal'
  });

  if (!info.isConfirmed) {
    // pengguna membatalkan, jangan lanjut
    return;
  }
  // ==================================================================

  const paketText = `${selectedPkg.label} - ${formatRupiah(selectedPkg.price)}`;
  const pesanTeks = `
Halo Admin HeroPay, saya ingin top up:

🎮 Game: ${selectedGame}
💎 Paket: ${paketText}
🧾 ID: ${uid}${zid ? "\nZone: " + zid : ""}

Mohon diproses ya, terima kasih!
  `;
  const encoded = encodeURIComponent(pesanTeks);
  const nomorWA = "6287874511180";

  // Simpan ke server (optional)
  try {
    await fetch("http://localhost:3000/api/transactions", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({
        game: selectedGame,
        packageName: selectedPkg.label,
        price: selectedPkg.price,
        userId: uid,
        zoneId: zid
      })
    });
  } catch (err) {
    console.warn("Server tidak aktif, lanjut kirim WA aja:", err);
  }

  // ✅ Gunakan tautan berbasis web WhatsApp dengan fallback
  const waUrl = `https://wa.me/${nomorWA}?text=${encoded}`;
  const fallbackUrl = `https://api.whatsapp.com/send?phone=${nomorWA}&text=${encoded}`;

  // Coba buka tautan WhatsApp
  try {
    window.open(waUrl, "_blank");
  } catch (err) {
    console.warn("Gagal membuka wa.me, mencoba fallback:", err);
    window.open(fallbackUrl, "_blank");
  }
}
</script>
<script>
  async function fetchPrices() {
    try {
      const response = await fetch("http://localhost:3000/api/prices");
      const prices = await response.json();
      Object.keys(prices).forEach((game) => {
        const gamePackages = prices[game];
        gamePackages.forEach((pkg) => {
          const el = document.querySelector(`.pkg[data-pkg-id="${pkg.id}"]`);
          if (el) {
            el.querySelector(".price").textContent = formatRupiah(pkg.price);
          }
        });
      });
    } catch (err) {
      console.error("Gagal memuat harga:", err);
    }
  }

  // Panggil fungsi untuk memuat harga terbaru saat halaman dimuat
  document.addEventListener("DOMContentLoaded", fetchPrices);
</script>
    <!-- POPUP MODAL SCRIPT -->
    <script>
      // Tampilkan popup saat halaman selesai dimuat
      window.addEventListener('DOMContentLoaded', function() {
        var modal = document.getElementById('popupModal');
        var closeBtn = document.getElementById('closePopup');
        modal.style.display = 'flex';
        closeBtn.onclick = function() {
          modal.style.display = 'none';
        };
        // Tutup popup jika klik di luar gambar/modal
        modal.onclick = function(e) {
          if (e.target === modal) modal.style.display = 'none';
        };
      });
    </script>
    <!-- SLIDESHOW SCRIPT (auto + manual + pause on hover + swipe) -->
    <script>
      (function () {
        const container = document.getElementById('slidesContainer');
        if (!container) return;
        const slides = Array.from(container.querySelectorAll('.slide'));
        const dotsWrap = document.getElementById('slideDots');
        const prevBtn = document.getElementById('slidePrev');
        const nextBtn = document.getElementById('slideNext');
        let current = 0;
        let interval = null;
        const delayMs = 4500;

        // create dots
        slides.forEach((_, i) => {
          const b = document.createElement('button');
          b.type = 'button';
          b.ariaLabel = 'Slide ' + (i + 1);
          b.addEventListener('click', () => { showSlide(i); resetTimer(); });
          dotsWrap.appendChild(b);
        });
        const dots = Array.from(dotsWrap.children);

        function calcHeightForImage(img) {
          if (!img) return container.clientHeight || 0;
          const nw = img.naturalWidth || img.width;
          const nh = img.naturalHeight || img.height;
          if (!nw || !nh) return img.getBoundingClientRect().height || 0;
          const cw = container.clientWidth || container.getBoundingClientRect().width;
          return Math.round(nh * (cw / nw));
        }

        function showSlide(idx) {
          if (idx < 0) idx = slides.length - 1;
          if (idx >= slides.length) idx = 0;
          const next = slides[idx];
          const prev = slides[current];
          if (!next) return;
          const img = next.querySelector('img');
          function doSwitch() {
            const h = calcHeightForImage(img);
            if (h) container.style.height = h + 'px';
            prev && prev.classList.remove('active');
            next.classList.add('active');
            dots.forEach(d => d.classList.remove('active'));
            dots[idx] && dots[idx].classList.add('active');
            current = idx;
          }
          if (img && !img.naturalWidth) {
            img.onload = () => { img.onload = null; doSwitch(); };
          } else {
            doSwitch();
          }
        }

        function nextSlide() { showSlide(current + 1); }
        function prevSlide() { showSlide(current - 1); }

        nextBtn?.addEventListener('click', () => { nextSlide(); resetTimer(); });
        prevBtn?.addEventListener('click', () => { prevSlide(); resetTimer(); });

        function startTimer() { stopTimer(); interval = setInterval(() => { nextSlide(); }, delayMs); }
        function stopTimer() { if (interval) { clearInterval(interval); interval = null; } }
        function resetTimer() { stopTimer(); startTimer(); }

        // pause on hover/focus
        container.addEventListener('mouseenter', stopTimer);
        container.addEventListener('mouseleave', startTimer);
        container.addEventListener('focusin', stopTimer);
        container.addEventListener('focusout', startTimer);

        // keyboard
        container.addEventListener('keydown', (e) => {
          if (e.key === 'ArrowLeft') { prevSlide(); resetTimer(); }
          if (e.key === 'ArrowRight') { nextSlide(); resetTimer(); }
        });

        // touch/swipe (mobile)
        let startX = null;
        container.addEventListener('touchstart', (e) => { startX = e.touches[0].clientX; stopTimer(); }, { passive: true });
        container.addEventListener('touchend', (e) => {
          if (startX === null) return;
          const endX = (e.changedTouches && e.changedTouches[0].clientX) || 0;
          const diff = endX - startX;
          if (Math.abs(diff) > 40) {
            if (diff > 0) prevSlide(); else nextSlide();
            resetTimer();
          } else {
            resetTimer();
          }
          startX = null;
        });

        // init and responsive height
        showSlide(0);
        startTimer();
        window.addEventListener('resize', () => {
          const activeImg = slides[current]?.querySelector('img');
          if (activeImg) container.style.height = calcHeightForImage(activeImg) + 'px';
        });
      })();
    </script>

    <!-- Tambahan: klik/tap pada gambar slideshow -> pilih game dan scroll ke katalog -->
    <script>
      (function () {
        const container = document.getElementById('slidesContainer');
        if (!container) return;
        const imgs = Array.from(container.querySelectorAll('.slide img'));
        imgs.forEach((img) => {
          // beri indikator interaktif
          img.style.cursor = 'pointer';
          const trySelect = () => {
            const src = (img.getAttribute('src') || '').toLowerCase();
            // Jika slide menunjukkan Mobile Legends (ml.jpg atau aspirant-iklan.jpg) -> pilih Mobile Legends
            if (src.includes('ml.jpg') || src.includes('aspirant-iklan.jpg')) {
              if (typeof selectGame === 'function') selectGame('Mobile Legends');
            } else if (src.includes('mn.png')) {
              // MN slide -> buka katalog Free Fire (sesuai mapping di halaman)
              if (typeof selectGame === 'function') selectGame('Free Fire');
            }
          };
          // klik untuk desktop & touchend untuk mobile/tap
          img.addEventListener('click', trySelect);
          img.addEventListener('touchend', function (e) {
            // touchend akan dipanggil juga pada tap — panggil handler
            trySelect();
          }, { passive: true });
        });
      })();
    </script>
  </body>
</html>